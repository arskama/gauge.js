<!DOCTYPE html>
<html>
<head>
  <title>metrics_gauje.js</title>
  <meta name="description" content="100% native and cool looking animated JavaScript gauge">
  <meta name="viewport" content="width=1024, maximum-scale=1">
  <link rel="shortcut icon" href="favicon.ico">
  <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
  <link href="assets/bootstrap.min.css" type="text/css" rel="stylesheet">
  <link href="assets/main.css?v=5" type="text/css" rel="stylesheet">
  <link href='http://fonts.googleapis.com/css?family=Amaranth:400,700|Just+Another+Hand' rel='stylesheet' type='text/css'>
  <link href="assets/prettify.css" type="text/css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/fd-slider/fd-slider.css?v=2">
  <link rel="stylesheet" type="text/css" href="assets/fd-slider/fd-slider-tooltip.css">
  <script type="text/javascript" src="assets/prettify.js"></script>
  <script type="text/javascript" src="assets/jscolor.js"></script>
  <!--[if lt IE 9]><script type="text/javascript" src="assets/excanvas.compiled.js"></script><![endif]-->
</head>
<body>
<div>
  <h2 id='CPSupport'> </h2>
</div>
<div id="content">
  <div id="metric_a">
    <h2>cpu Speed</h2>
    <div id="metric_a">
      <canvas width=400 height=200 id="canvas_metric_a"></canvas>
      <div id="metric_a-textfield"></div>
    </div>
  </div>
  <div id="metric_b">
    <h2>cpu Utilization</h2>
    <div id="metric_b">
      <div id="metric_b-textfield"></div>
      <canvas width=400 height=200 id="canvas_metric_b"></canvas>
    </div>
  </div>
</div> <!--content-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="assets/fd-slider/fd-slider.js"></script>
<script src="dist/gauge.js"></script>


<script type="text/javascript">
if('ComputePressureObserver' in window) {

  document.getElementById('CPSupport').innerHTML = 'Compute Pressure available';
  const observer = new ComputePressureObserver(
    computePressureCallback,
    {
      cpuUtilizationThresholds: [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1],
      cpuSpeedThresholds: [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1],
    });

    observer.observe();

    function computePressureCallback(update) {
      console.log("cpu speed: " + update.cpuSpeed);
      console.log("cpu utils: " + update.cpuUtilization);

      gauge_a.set(update.cpuSpeed * 100);
      gauge_b.set(update.cpuUtilization * 100);
    }



var bigFont = "14px sans-serif";
var opts = {
  angle: 0.0, /// The span of the gauge arc
  lineWidth: 0.2, // The line thickness
  radiusScale: 0.9,
  fontSize: 0.2,
  pointer: {
    length: 0.6, // Relative to gauge radius
    strokeWidth: 0.05 // The thickness
  },
  renderTicks: {
          divisions: 10,
          divWidth: 1.1,
          divLength: 0.7,
          divColor: "#333333",
          subDivisions: 2,
          subLength: 0.2,
          subWidth: 0.6,
          subColor: "#666666",
  },
  staticLabels: {
    font: "10px sans-serif",  // Specifies font
    labels: [{label:0, font: bigFont},
             {label:10, font: bigFont},
             {label:20, font: bigFont},
             {label:30, font: bigFont},
             {label:40, font: bigFont},
             {label:50, font: bigFont},
             {label:60, font: bigFont},
             {label:70, font: bigFont},
             {label:80, font: bigFont},
             {label:90, font: bigFont},
             {label:100, font: bigFont}],

    color: "#000000",  // Optional: Label text color
    fractionDigits: 0  // Optional: Numerical precision. 0=round off.
  },
  strokeColor: '#E0E0E0',   // to see which ones work best for you
//  staticZones: [
//    {strokeStyle: "#30B32D", min: 0, max: 60}, // Red from 100 to 130
//    {strokeStyle: "#FFDD00", min: 60, max: 90}, // Yellow
//    {strokeStyle: "#F03E3E", min: 90, max: 100}, // Green
//  ],
  generateGradient: true,
};
var target_a = document.getElementById('canvas_metric_a'); // your canvas element
var gauge_a = new Gauge(target_a).setOptions(opts); // create sexy gauge!
gauge_a.setTextField(document.getElementById("metric_a-textfield"));
gauge_a.maxValue = 100; // set max gauge value
gauge_a.MinValue = 0;  // set min value
gauge_a.set(0); // set actual value

var target_b = document.getElementById('canvas_metric_b'); // your canvas element
var gauge_b = new Gauge(target_b).setOptions(opts); // create sexy gauge!
gauge_b.setTextField(document.getElementById("metric_b-textfield"));
gauge_b.maxValue = 100; // set max gauge value
gauge_b.MinValue = 0;  // set min value
gauge_b.set(0); // set actual value
}else{
  document.getElementById('CPSupport').innerText = 'Compute Pressure NOT available';
}
</script>
